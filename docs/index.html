<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RideNDine | Home Chef Delivery Platform</title>
  
  <!-- Icons & Manifest -->
  <link rel="icon" href="/assets/app-icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/assets/app-icon.svg" />
  <link rel="manifest" href="/manifest.webmanifest" />
  <meta name="theme-color" content="#ff7a18" />
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://unpkg.com" />
  
  <!-- Leaflet CSS (for map pages) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  
  <!-- Main Styles -->
  <link rel="stylesheet" href="/ui.css" />
  <link rel="stylesheet" href="/layout.css" />
  <link rel="stylesheet" href="/styles.css" />
  
  <!-- Meta Description -->
  <meta name="description" content="RideNDine connects home chefs with hungry neighbors across Hamilton. Order fresh, home-cooked meals for delivery." />
  
  <!-- Open Graph / Social -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="RideNDine | Home Chef Delivery" />
  <meta property="og:description" content="Fresh home-cooked meals from local chefs, delivered to your door." />
  
  <style>
    /* DEV BUILD Banner */
    .dev-banner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.5rem;
      text-align: center;
      font-size: 0.875rem;
      font-weight: 600;
      z-index: 10000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    
    .dev-banner.hidden {
      display: none;
    }
    
    /* Static Demo Banner */
    .static-demo-banner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 0.5rem;
      text-align: center;
      font-size: 0.875rem;
      font-weight: 600;
      z-index: 10000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    
    .static-demo-banner.hidden {
      display: none;
    }
    
    body.dev-mode {
      padding-top: 40px;
    }
    
    body.static-demo-mode {
      padding-top: 40px;
    }
    
    /* Loading Spinner */
    .loading-spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 9999;
    }
    
    .loading-spinner.active {
      display: block;
    }
    
    .spinner {
      border: 4px solid rgba(255, 122, 24, 0.1);
      border-left-color: #ff7a18;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* App Container */
    #app {
      min-height: 100vh;
    }
  </style>
</head>
<body>
  <!-- DEV BUILD Banner (shown when on dev/staging) -->
  <div id="dev-banner" class="dev-banner hidden">
    ðŸš§ DEV BUILD - This is a development/staging environment ðŸš§
  </div>
  
  <!-- Static Demo Banner (shown when backend API is not available) -->
  <div id="static-demo-banner" class="static-demo-banner hidden">
    ðŸ“± STATIC DEMO - Backend API not available. Browse the app, but features requiring a server won't work.
  </div>
  
  <!-- Loading Spinner -->
  <div id="loading-spinner" class="loading-spinner">
    <div class="spinner"></div>
  </div>
  
  <!-- Main App Container (pages load here) -->
  <div id="app">
    <!-- Initial loading state -->
    <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh;">
      <div class="spinner"></div>
    </div>
  </div>
  
  <!-- Leaflet JS (for map pages) -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  
  <!-- Core Scripts -->
  <script src="/layout.js"></script>
  <script src="/auth-client.js"></script>
  <script src="/router.js"></script>
  <script src="/routes.js"></script>
  
  <script>
    // Show DEV banner on non-production environments
    (function() {
      const hostname = window.location.hostname;
      const isDev = hostname === 'localhost' || 
                    hostname === '127.0.0.1' || 
                    hostname.includes('dev') ||
                    hostname.includes('staging');
      
      if (isDev) {
        const banner = document.getElementById('dev-banner');
        if (banner) {
          banner.classList.remove('hidden');
          document.body.classList.add('dev-mode');
        }
      }
    })();
    
    // Show static demo banner when backend is not available (GitHub Pages)
    (function() {
      const hostname = window.location.hostname;
      const isGitHubPages = hostname.endsWith('.github.io') || hostname === 'github.io';
      
      if (isGitHubPages) {
        const banner = document.getElementById('static-demo-banner');
        if (banner) {
          banner.classList.remove('hidden');
          document.body.classList.add('static-demo-mode');
        }
      }
    })();
    
    // Global error handler
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error);
    });
    
    // Global loading indicator helpers
    window.showLoading = function() {
      document.getElementById('loading-spinner')?.classList.add('active');
    };
    
    window.hideLoading = function() {
      document.getElementById('loading-spinner')?.classList.remove('active');
    };
  </script>
</body>
</html>
